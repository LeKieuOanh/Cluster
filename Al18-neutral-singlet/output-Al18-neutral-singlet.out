#INFO: **** input file is /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al18-neutral-singlet/input.py ****
import numpy
from pyscf import gto, scf, dft, mp, cc
from pyscf.mp import uobmp2_mom_conv, dfuobmp2_mom_conv, uhf_mom
from pyscf.mp import  mp2, ump2
from pyscf.tools import molden
import os
from functools import reduce


mol = gto.Mole()
geom = os.environ.get('geom_txt')
mol.atom = geom
mol.basis = os.environ.get('basis', 'cc-pvdz')
mol.unit = 'A'
mol.charge = int(os.environ.get('charge', 0))
mol.spin = int(os.environ.get('spin', 0))
mol.verbose = 4
mol.build()

#################### Ground state using density fitting
### Hartree-Fock
a  = scf.UHF(mol).density_fit()
a.kernel()

### Ground state OBMP2 calculation
ob = dfuobmp2_mom_conv.DFUOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 1
ob.cos = 1
e_obmp2g = ob.kernel()

### Ground state O2BMP2 calculation
ob = dfuobmp2_mom_conv.DFUOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 0                             
ob.cos = 1.2                             
e_o2bmp2g = ob.kernel()  

#################### Ground state NOT using density fitting
### Hartree-Fock
a  = scf.UHF(mol)
a.kernel()

### Ground state OBMP2 calculation
ob = uobmp2_mom_conv.UOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 1
ob.cos = 1
#e_obmp2g = ob.kernel()

### Ground state O2BMP2 calculation
ob = uobmp2_mom_conv.UOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 0
ob.cos = 1.2   ## the cos can be vary ...                        	 
#e_o2bmp2g = ob.kernel()


## Results from density-fitting approximate with non-using density fitting 
## check results between df and non-df with small molecules before running the important molecules
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='comphys', release='3.10.0-1160.119.1.el7.x86_64', version='#1 SMP Tue Jun 4 14:43:51 UTC 2024', machine='x86_64', processor='x86_64')  Threads 8
Python 3.7.9 (default, Dec  4 2023, 13:00:18) 
[GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]
numpy 1.21.6  scipy 1.7.3
Date: Tue May 27 22:40:50 2025
PySCF version 1.7.0
PySCF path  /share/installs/pyscf/pyscf
GIT HEAD      ref: refs/heads/ob-mp2
GIT ob-mp2 branch  f0fc63383ab6c719c0c91f5e07a6895c637b700d

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 18
[INPUT] num. electrons = 234
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 Al    -0.008744000000  -1.663393000000   2.265058000000 AA   -0.016523765233  -3.143357207519   4.280339276255 Bohr
[INPUT]  2 Al    -1.253831000000  -2.687221000000   0.000000000000 AA   -2.369397196490  -5.078111726180   0.000000000000 Bohr
[INPUT]  3 Al    -0.433858000000   1.064704000000   2.341559000000 AA   -0.819872796952   2.011998963729   4.424905214510 Bohr
[INPUT]  4 Al    -0.008744000000  -1.663393000000  -2.265058000000 AA   -0.016523765233  -3.143357207519  -4.280339276255 Bohr
[INPUT]  5 Al    -2.401372000000  -0.641207000000  -1.365659000000 AA   -4.537935403199  -1.211705619154  -2.580721489547 Bohr
[INPUT]  6 Al     2.090642000000   0.006584000000   1.503608000000 AA    3.950740804513   0.012441956804   2.841407318705 Bohr
[INPUT]  7 Al    -2.401372000000  -0.641207000000   1.365659000000 AA   -4.537935403199  -1.211705619154   2.580721489547 Bohr
[INPUT]  8 Al     1.751196000000  -2.165601000000   0.000000000000 AA    3.309280830434  -4.092392785084   0.000000000000 Bohr
[INPUT]  9 Al     1.551479000000   2.145856000000   0.000000000000 AA    2.931870398014   4.055080142755   0.000000000000 Bohr
[INPUT] 10 Al    -0.433858000000   1.064704000000  -2.341559000000 AA   -0.819872796952   2.011998963729  -4.424905214510 Bohr
[INPUT] 11 Al     2.090642000000   0.006584000000  -1.503608000000 AA    3.950740804513   0.012441956804  -2.841407318705 Bohr
[INPUT] 12 Al    -2.062804000000   1.742408000000   0.000000000000 AA   -3.898134608657   3.292673917251   0.000000000000 Bohr
[INPUT] 13 Al     0.587336000000  -4.304344000000   1.338778000000 AA    1.109904183098  -8.134031305915   2.529923761593 Bohr
[INPUT] 14 Al    -0.441998000000   3.591195000000  -1.394905000000 AA   -0.835255167606   6.786375009907  -2.635988419786 Bohr
[INPUT] 15 Al     0.587336000000  -4.304344000000  -1.338778000000 AA    1.109904183098  -8.134031305915  -2.529923761593 Bohr
[INPUT] 16 Al    -0.113483000000  -0.124149000000   0.000000000000 AA   -0.214451789794  -0.234607608639   0.000000000000 Bohr
[INPUT] 17 Al    -0.441998000000   3.591195000000   1.394905000000 AA   -0.835255167606   6.786375009907   2.635988419786 Bohr
[INPUT] 18 Al     1.343430000000   4.981628000000   0.000000000000 AA    2.538714767524   9.413912574465   0.000000000000 Bohr

nuclear repulsion = 3494.87105083614
number of shells = 90
number of NR pGTOs = 972
number of NR cGTOs = 162
basis = sto-6g
ecp = {}
CPU time:         1.37


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DFHF'> ********
method = DFHF-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al18-neutral-singlet/tmpe22i0hry
max_memory 4000 MB (current use 60 MB)
number electrons alpha = 117  beta = 117
Set gradient conv threshold to 3.16228e-05
******** <class 'pyscf.df.df.DF'> ********
auxbasis = None
max_memory = 4000
_cderi_to_save = /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al18-neutral-singlet/tmp47dantcm
Even tempered Gaussians are generated as DF auxbasis for  Al
init E= -4333.08015724595
  alpha nocc = 117  HOMO = -0.932499533692061  LUMO = -0.911792388953687
  beta  nocc = 117  HOMO = -0.90704035858158  LUMO = -0.891763547390776
cycle= 1 E= -4333.76762001435  delta_E= -0.687  |g|= 1.72  |ddm|= 5.33
  alpha nocc = 117  HOMO = 0.333030814447334  LUMO = 0.352146495866067
  beta  nocc = 117  HOMO = 0.33121669791926  LUMO = 0.354660571311238
cycle= 2 E= -4322.63199281986  delta_E= 11.1  |g|= 3.28  |ddm|= 6.75
  alpha nocc = 117  HOMO = 0.204263230551776  LUMO = 0.258536276264692
  beta  nocc = 117  HOMO = 0.206243024603394  LUMO = 0.254909360538604
