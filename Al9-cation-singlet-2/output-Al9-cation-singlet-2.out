#INFO: **** input file is /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al9-cation-singlet-2/input.py ****
import numpy
from pyscf import gto, scf, dft, mp, cc
from pyscf.mp import uobmp2_mom_conv, dfuobmp2_mom_conv, uhf_mom
from pyscf.mp import  mp2, ump2
from pyscf.tools import molden
import os
from functools import reduce


mol = gto.Mole()
geom = os.environ.get('geom_txt')
mol.atom = geom
mol.basis = os.environ.get('basis', 'cc-pvdz')
mol.unit = 'A'
mol.charge = int(os.environ.get('charge', 0))
mol.spin = int(os.environ.get('spin', 0))
mol.verbose = 4
mol.build()

#################### Ground state using density fitting
### Hartree-Fock
a  = scf.UHF(mol).density_fit()
a.kernel()

### Ground state OBMP2 calculation
ob = dfuobmp2_mom_conv.DFUOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 1
ob.cos = 1
e_obmp2g = ob.kernel()

### Ground state O2BMP2 calculation
ob = dfuobmp2_mom_conv.DFUOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 0                             
ob.cos = 1.2                             
e_o2bmp2g = ob.kernel()  

#################### Ground state NOT using density fitting
### Hartree-Fock
a  = scf.UHF(mol)
a.kernel()

### Ground state OBMP2 calculation
ob = uobmp2_mom_conv.UOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 1
ob.cos = 1
#e_obmp2g = ob.kernel()

### Ground state O2BMP2 calculation
ob = uobmp2_mom_conv.UOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 0
ob.cos = 1.2   ## the cos can be vary ...                        	 
#e_o2bmp2g = ob.kernel()


## Results from density-fitting approximate with non-using density fitting 
## check results between df and non-df with small molecules before running the important molecules
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='comphys', release='3.10.0-1160.119.1.el7.x86_64', version='#1 SMP Tue Jun 4 14:43:51 UTC 2024', machine='x86_64', processor='x86_64')  Threads 8
Python 3.7.9 (default, Dec  4 2023, 13:00:18) 
[GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]
numpy 1.21.6  scipy 1.7.3
Date: Mon May 19 17:31:12 2025
PySCF version 1.7.0
PySCF path  /share/installs/pyscf/pyscf
GIT HEAD      ref: refs/heads/ob-mp2
GIT ob-mp2 branch  f0fc63383ab6c719c0c91f5e07a6895c637b700d

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 9
[INPUT] num. electrons = 44
[INPUT] charge = 1
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 H      1.512325000000   2.916697000000   0.000000000000 AA    2.857880061333   5.511758518341   0.000000000000 Bohr
[INPUT]  2 He    -1.935131000000   0.174582000000   0.000000000000 AA   -3.656867605156   0.329912166279   0.000000000000 Bohr
[INPUT]  3 Li    -0.142352000000  -0.822744000000   1.741997000000 AA   -0.269006293284  -1.554760830629   3.291897239814 Bohr
[INPUT]  4 Be    -1.636018000000  -2.540967000000   0.000000000000 AA   -3.091625954859  -4.801731721558   0.000000000000 Bohr
[INPUT]  5 B      0.975492000000  -2.534817000000   0.000000000000 AA    1.843412716704  -4.790109905892   0.000000000000 Bohr
[INPUT]  6 C     -0.142352000000   1.775073000000  -1.630204000000 AA   -0.269006293284   3.354401821110  -3.080639087170 Bohr
[INPUT]  7 N      1.652740000000   0.079845000000   0.000000000000 AA    3.123225955114   0.150885182416   0.000000000000 Bohr
[INPUT]  8 O     -0.142352000000   1.775073000000   1.630204000000 AA   -0.269006293284   3.354401821110   3.080639087170 Bohr
[INPUT]  9 F     -0.142352000000  -0.822744000000  -1.741997000000 AA   -0.269006293284  -1.554760830629  -3.291897239814 Bohr

nuclear repulsion = 143.65468315684
number of shells = 23
number of NR pGTOs = 222
number of NR cGTOs = 37
basis = sto-6g
ecp = {}
CPU time:         1.41


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DFHF'> ********
method = DFHF-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al9-cation-singlet-2/tmpcfvgebjc
max_memory 4000 MB (current use 60 MB)
number electrons alpha = 22  beta = 22
Set gradient conv threshold to 3.16228e-05
******** <class 'pyscf.df.df.DF'> ********
auxbasis = None
max_memory = 4000
_cderi_to_save = /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al9-cation-singlet-2/tmpqp1vhlv9
Even tempered Gaussians are generated as DF auxbasis for  He N Be Li C H F O B
init E= -312.400269609371
  alpha nocc = 22  HOMO = -0.25620804664933  LUMO = -0.250920045498114
  beta  nocc = 22  HOMO = -0.250446714188898  LUMO = -0.246773488010725
cycle= 1 E= -312.363908164041  delta_E= 0.0364  |g|= 0.502  |ddm|= 2.17
  alpha nocc = 22  HOMO = -0.132438821374532  LUMO = -0.131019320082287
  beta  nocc = 22  HOMO = -0.134626244549271  LUMO = -0.133032465123333

WARN: system HOMO -0.134626244549271 >= system LUMO -0.133032465123333

cycle= 2 E= -303.545436213252  delta_E= 8.82  |g|= 1.57  |ddm|= 4.25
  alpha nocc = 22  HOMO = -0.258866241873237  LUMO = -0.217922422769206
  beta  nocc = 22  HOMO = -0.269898900887247  LUMO = -0.219037739834287
cycle= 3 E= -304.986460621405  delta_E= -1.44  |g|=    1  |ddm|= 2.24
  alpha nocc = 22  HOMO = -0.217398153132051  LUMO = -0.200792648542851
  beta  nocc = 22  HOMO = -0.2128613018542  LUMO = -0.201700528920232
cycle= 4 E= -311.66879007754  delta_E= -6.68  |g|= 1.01  |ddm|= 3.88
  alpha nocc = 22  HOMO = -0.235504545639983  LUMO = -0.206940190441543
  beta  nocc = 22  HOMO = -0.227865599316215  LUMO = -0.206113901745175
cycle= 5 E= -312.987036375269  delta_E= -1.32  |g|= 0.552  |ddm|= 1.83
  alpha nocc = 22  HOMO = -0.24519234171923  LUMO = -0.206938067827194
  beta  nocc = 22  HOMO = -0.246958477019544  LUMO = -0.200575216716429
cycle= 6 E= -312.983604520013  delta_E= 0.00343  |g|= 0.552  |ddm|= 0.0747
  alpha nocc = 22  HOMO = -0.247447430211863  LUMO = -0.20204118518844
  beta  nocc = 22  HOMO = -0.220871437277355  LUMO = -0.210929163541011
cycle= 7 E= -312.976373694518  delta_E= 0.00723  |g|= 0.61  |ddm|= 1.33
  alpha nocc = 22  HOMO = -0.286247374480689  LUMO = -0.174678893937757
  beta  nocc = 22  HOMO = -0.245349727511375  LUMO = -0.165719401781264
cycle= 8 E= -312.930310940131  delta_E= 0.0461  |g|= 0.603  |ddm|= 0.457
  alpha nocc = 22  HOMO = -0.277932012251021  LUMO = -0.165904820553105
  beta  nocc = 22  HOMO = -0.250235057111763  LUMO = -0.155198840170076
cycle= 9 E= -312.961424116765  delta_E= -0.0311  |g|= 0.593  |ddm|= 0.133
  alpha nocc = 22  HOMO = -0.341981617389038  LUMO = -0.126342491580694
  beta  nocc = 22  HOMO = -0.255899301275775  LUMO = -0.183856115793569
cycle= 10 E= -312.828293746402  delta_E= 0.133  |g|= 0.521  |ddm|= 0.486
  alpha nocc = 22  HOMO = -0.26675138495899  LUMO = -0.127595485499709
  beta  nocc = 22  HOMO = -0.257014836617225  LUMO = -0.122600975770039
cycle= 11 E= -313.068246712535  delta_E= -0.24  |g|= 0.522  |ddm|= 0.412
  alpha nocc = 22  HOMO = -0.314819464986224  LUMO = -0.104658610015374
  beta  nocc = 22  HOMO = -0.31332965543776  LUMO = -0.106896971629005
cycle= 12 E= -305.098029833627  delta_E= 7.97  |g|= 1.04  |ddm|= 3.47
  alpha nocc = 22  HOMO = -0.230477760379923  LUMO = -0.136023491817804
  beta  nocc = 22  HOMO = -0.202743291782696  LUMO = -0.138576757314496
cycle= 13 E= -313.089123264792  delta_E= -7.99  |g|=  0.5  |ddm|= 3.47
  alpha nocc = 22  HOMO = -0.206419283345558  LUMO = -0.185487782767759
  beta  nocc = 22  HOMO = -0.183114920486569  LUMO = -0.179238602521263
cycle= 14 E= -313.825019682644  delta_E= -0.736  |g|= 0.532  |ddm|= 1.08
  alpha nocc = 22  HOMO = -0.203979823867787  LUMO = -0.140600362703837
  beta  nocc = 22  HOMO = -0.208455537146818  LUMO = -0.137131606872017
cycle= 15 E= -314.203000168476  delta_E= -0.378  |g|= 0.237  |ddm|= 0.757
  alpha nocc = 22  HOMO = -0.32823096791271  LUMO = -0.128624909597615
  beta  nocc = 22  HOMO = -0.334736141987893  LUMO = -0.14406147689164
cycle= 16 E= -314.252775014861  delta_E= -0.0498  |g|= 0.115  |ddm|= 0.486
  alpha nocc = 22  HOMO = -0.332884528541762  LUMO = -0.11809930465769
  beta  nocc = 22  HOMO = -0.32090031681813  LUMO = -0.139404944152289
cycle= 17 E= -314.269681760938  delta_E= -0.0169  |g|= 0.118  |ddm|= 0.211
  alpha nocc = 22  HOMO = -0.326115240621561  LUMO = -0.113030257273521
  beta  nocc = 22  HOMO = -0.323772953315551  LUMO = -0.132725593893742
cycle= 18 E= -314.255630653797  delta_E= 0.0141  |g|= 0.111  |ddm|= 0.174
  alpha nocc = 22  HOMO = -0.306443311778978  LUMO = -0.105019462686891
  beta  nocc = 22  HOMO = -0.318630408070216  LUMO = -0.120989040902219
cycle= 19 E= -314.241826292038  delta_E= 0.0138  |g|= 0.0977  |ddm|= 0.384
  alpha nocc = 22  HOMO = -0.30905030291823  LUMO = -0.138198223849575
  beta  nocc = 22  HOMO = -0.290690238964546  LUMO = -0.159916900602237
cycle= 20 E= -314.257247431664  delta_E= -0.0154  |g|= 0.0909  |ddm|= 0.302
  alpha nocc = 22  HOMO = -0.293881073636875  LUMO = -0.159831730886765
  beta  nocc = 22  HOMO = -0.266592490103898  LUMO = -0.181015564913245
cycle= 21 E= -314.274314730207  delta_E= -0.0171  |g|= 0.049  |ddm|= 0.338
  alpha nocc = 22  HOMO = -0.297719360353451  LUMO = -0.164485174779388
  beta  nocc = 22  HOMO = -0.278804305660577  LUMO = -0.167788500185946
cycle= 22 E= -314.291573834521  delta_E= -0.0173  |g|= 0.0634  |ddm|= 0.35
  alpha nocc = 22  HOMO = -0.294735041289063  LUMO = -0.162326344855567
  beta  nocc = 22  HOMO = -0.282444854242104  LUMO = -0.157734156581575
cycle= 23 E= -314.30344642671  delta_E= -0.0119  |g|= 0.0977  |ddm|= 0.195
  alpha nocc = 22  HOMO = -0.298889292906993  LUMO = -0.147321969774881
  beta  nocc = 22  HOMO = -0.273395674453536  LUMO = -0.161357366033431
cycle= 24 E= -314.28782176522  delta_E= 0.0156  |g|= 0.0689  |ddm|= 0.246
  alpha nocc = 22  HOMO = -0.295760195286877  LUMO = -0.154811061277771
  beta  nocc = 22  HOMO = -0.270075056609427  LUMO = -0.168272257487895
cycle= 25 E= -314.290711177144  delta_E= -0.00289  |g|= 0.0564  |ddm|= 0.192
  alpha nocc = 22  HOMO = -0.281141037371391  LUMO = -0.153436610380738
  beta  nocc = 22  HOMO = -0.269244523248728  LUMO = -0.151695821993671
cycle= 26 E= -314.296664525116  delta_E= -0.00595  |g|= 0.0383  |ddm|= 0.221
  alpha nocc = 22  HOMO = -0.281257671710643  LUMO = -0.155291769770397
  beta  nocc = 22  HOMO = -0.269316827230787  LUMO = -0.153414022056631
cycle= 27 E= -314.296239626542  delta_E= 0.000425  |g|= 0.038  |ddm|= 0.0278
  alpha nocc = 22  HOMO = -0.281598006035334  LUMO = -0.163029819557153
  beta  nocc = 22  HOMO = -0.2672403557215  LUMO = -0.16074266783195
cycle= 28 E= -314.296190814628  delta_E= 4.88e-05  |g|= 0.0402  |ddm|= 0.0668
  alpha nocc = 22  HOMO = -0.297816094960349  LUMO = -0.145053663843313
  beta  nocc = 22  HOMO = -0.28035705732155  LUMO = -0.155952387632148
