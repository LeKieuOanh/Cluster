#INFO: **** input file is /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al13-anion-singlet/input.py ****
import numpy
from pyscf import gto, scf, dft, mp, cc
from pyscf.mp import uobmp2_mom_conv, dfuobmp2_mom_conv, uhf_mom
from pyscf.mp import  mp2, ump2
from pyscf.tools import molden
import os
from functools import reduce


mol = gto.Mole()
geom = os.environ.get('geom_txt')
mol.atom = geom
mol.basis = os.environ.get('basis', 'cc-pvdz')
mol.unit = 'A'
mol.charge = int(os.environ.get('charge', 0))
mol.spin = int(os.environ.get('spin', 0))
mol.verbose = 4
mol.build()

#################### Ground state using density fitting
### Hartree-Fock
a  = scf.UHF(mol).density_fit()
a.kernel()

### Ground state OBMP2 calculation
ob = dfuobmp2_mom_conv.DFUOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 1
ob.cos = 1
e_obmp2g = ob.kernel()

### Ground state O2BMP2 calculation
ob = dfuobmp2_mom_conv.DFUOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 0                             
ob.cos = 1.2                             
e_o2bmp2g = ob.kernel()  

#################### Ground state NOT using density fitting
### Hartree-Fock
a  = scf.UHF(mol)
a.kernel()

### Ground state OBMP2 calculation
ob = uobmp2_mom_conv.UOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 1
ob.cos = 1
#e_obmp2g = ob.kernel()

### Ground state O2BMP2 calculation
ob = uobmp2_mom_conv.UOBMP2(a)
ob.second_order = True
ob.thresh = 10e-6
ob.css = 0
ob.cos = 1.2   ## the cos can be vary ...                        	 
#e_o2bmp2g = ob.kernel()


## Results from density-fitting approximate with non-using density fitting 
## check results between df and non-df with small molecules before running the important molecules
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='comphys', release='3.10.0-1160.119.1.el7.x86_64', version='#1 SMP Tue Jun 4 14:43:51 UTC 2024', machine='x86_64', processor='x86_64')  Threads 8
Python 3.7.9 (default, Dec  4 2023, 13:00:18) 
[GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]
numpy 1.21.6  scipy 1.7.3
Date: Tue May 27 18:10:44 2025
PySCF version 1.7.0
PySCF path  /share/installs/pyscf/pyscf
GIT HEAD      ref: refs/heads/ob-mp2
GIT ob-mp2 branch  f0fc63383ab6c719c0c91f5e07a6895c637b700d

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 13
[INPUT] num. electrons = 170
[INPUT] charge = -1
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 Al     0.000933000000  -0.001419000000  -2.684111000000 AA    0.001763114474  -0.002681521371  -5.072234677932 Bohr
[INPUT]  2 Al     0.376835000000   2.370415000000  -1.201494000000 AA    0.712114944150   4.479435151561  -2.270494600308 Bohr
[INPUT]  3 Al     2.371739000000   0.374066000000  -1.199744000000 AA    4.481937148950   0.706882292512  -2.267187579590 Bohr
[INPUT]  4 Al     1.089558000000  -2.140105000000  -1.198861000000 AA    2.058966216829  -4.044212327812  -2.265518951422 Bohr
[INPUT]  5 Al    -1.089560000000   2.140107000000   1.198860000000 AA   -2.058969996281   4.044216107265   2.265517061696 Bohr
[INPUT]  6 Al     1.697780000000   1.697602000000   1.200064000000 AA    3.208339219764   3.208002848514   2.267792291950 Bohr
[INPUT]  7 Al     2.138267000000  -1.090053000000   1.201691000000 AA    4.040739011195  -2.059901631261   2.270866876355 Bohr
[INPUT]  8 Al    -0.000934000000   0.001419000000   2.684114000000 AA   -0.001765004200   0.002681521371   5.072240347111 Bohr
[INPUT]  9 Al    -1.697778000000  -1.697602000000  -1.200065000000 AA   -3.208335440312  -3.208002848514  -2.267794181676 Bohr
[INPUT] 10 Al    -2.138266000000   1.090053000000  -1.201691000000 AA   -4.040737121469   2.059901631261  -2.270866876355 Bohr
[INPUT] 11 Al    -2.371741000000  -0.374068000000   1.199744000000 AA   -4.481940928402  -0.706886071964   2.267187579590 Bohr
[INPUT] 12 Al    -0.376834000000  -2.370416000000   1.201493000000 AA   -0.712113054424  -4.479437041287   2.270492710582 Bohr
[INPUT] 13 Al     0.000000000000   0.000000000000   0.000001000000 AA    0.000000000000   0.000000000000   0.000001889726 Bohr

nuclear repulsion = 2037.94222094984
number of shells = 65
number of NR pGTOs = 702
number of NR cGTOs = 117
basis = sto-6g
ecp = {}
CPU time:         1.38


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DFHF'> ********
method = DFHF-UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al13-anion-singlet/tmprs9f5oj7
max_memory 4000 MB (current use 60 MB)
number electrons alpha = 85  beta = 85
Set gradient conv threshold to 3.16228e-05
******** <class 'pyscf.df.df.DF'> ********
auxbasis = None
max_memory = 4000
_cderi_to_save = /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al13-anion-singlet/tmpcppgd0vg
Even tempered Gaussians are generated as DF auxbasis for  Al
init E= -3129.92792040902
  alpha nocc = 85  HOMO = -0.793375143034646  LUMO = -0.648842640354979
  beta  nocc = 85  HOMO = -0.736348213287858  LUMO = -0.637588369269481
cycle= 1 E= -3130.30807551091  delta_E= -0.38  |g|= 1.26  |ddm|= 4.47
  alpha nocc = 85  HOMO = 0.44205479947453  LUMO = 0.508838788881602
  beta  nocc = 85  HOMO = 0.439318758691306  LUMO = 0.510360262371157
cycle= 2 E= -3131.02634603426  delta_E= -0.718  |g|= 0.838  |ddm|= 3.51
  alpha nocc = 85  HOMO = 0.186131267978165  LUMO = 0.393284404322176
  beta  nocc = 85  HOMO = 0.19153515757991  LUMO = 0.391255553627069
cycle= 3 E= -3131.61031276001  delta_E= -0.584  |g|= 0.0532  |ddm|= 1.33
  alpha nocc = 85  HOMO = 0.170939016422468  LUMO = 0.381166637424865
  beta  nocc = 85  HOMO = 0.173477653992717  LUMO = 0.379438999319432
cycle= 4 E= -3131.61378814579  delta_E= -0.00348  |g|= 0.0103  |ddm|= 0.11
  alpha nocc = 85  HOMO = 0.168795129166538  LUMO = 0.378909684235355
  beta  nocc = 85  HOMO = 0.169797085690348  LUMO = 0.377826651267826
cycle= 5 E= -3131.61405053857  delta_E= -0.000262  |g|= 0.00337  |ddm|= 0.0392
  alpha nocc = 85  HOMO = 0.169219535062833  LUMO = 0.378830657428247
  beta  nocc = 85  HOMO = 0.169410573070479  LUMO = 0.37837478540315
cycle= 6 E= -3131.61409165919  delta_E= -4.11e-05  |g|= 0.00128  |ddm|= 0.0196
  alpha nocc = 85  HOMO = 0.169284612645461  LUMO = 0.3787369238305
  beta  nocc = 85  HOMO = 0.169380051671971  LUMO = 0.378471096088303
cycle= 7 E= -3131.61409351577  delta_E= -1.86e-06  |g|= 0.00163  |ddm|= 0.00542
  alpha nocc = 85  HOMO = 0.169333714615262  LUMO = 0.378650085195909
  beta  nocc = 85  HOMO = 0.169357272270732  LUMO = 0.378549043935446
cycle= 8 E= -3131.61409689004  delta_E= -3.37e-06  |g|= 0.000259  |ddm|= 0.0044
  alpha nocc = 85  HOMO = 0.169345735622939  LUMO = 0.378602677590147
  beta  nocc = 85  HOMO = 0.169345402202378  LUMO = 0.378582213344763
cycle= 9 E= -3131.61409711629  delta_E= -2.26e-07  |g|= 7.24e-05  |ddm|= 0.0017
  alpha nocc = 85  HOMO = 0.169343979603609  LUMO = 0.378593200469924
  beta  nocc = 85  HOMO = 0.169344071499639  LUMO = 0.378590605449006
cycle= 10 E= -3131.61409713476  delta_E= -1.85e-08  |g|= 1.44e-05  |ddm|= 0.000475
  alpha nocc = 85  HOMO = 0.169344267484689  LUMO = 0.378592333904645
  beta  nocc = 85  HOMO = 0.169344323562883  LUMO = 0.378592268208451
cycle= 11 E= -3131.61409713543  delta_E= -6.65e-10  |g|= 2.33e-06  |ddm|= 9.08e-05
  alpha nocc = 85  HOMO = 0.169344314898023  LUMO = 0.378592363730786
  beta  nocc = 85  HOMO = 0.169344328854105  LUMO = 0.378592297085271
Extra cycle  E= -3131.61409713544  delta_E= -1.73e-11  |g|= 1.77e-06  |ddm|= 9.92e-06
converged SCF energy = -3131.61409713544  <S^2> = 1.3239827e-09  2S+1 = 1
shift = 0
thresh = 1e-05 
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.36 sec, wall time      0.09 sec
shape (1469, 3744)
1st memory: 611.8 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 465.0 MiB

========================
iter = 0  energy = -3132.602791 energy diff = 3132.602791
multiplicity <S^2> : Reference = 1.3239685e-09 Response = 1.322025e-09 Projector = 1.3200815e-09
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.36 sec, wall time      0.09 sec
shape (1469, 3744)
1st memory: 598.1 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 466.7 MiB

========================
iter = 1  energy = -3132.570633 energy diff = 0.032158
multiplicity <S^2> : Reference = 7.4697937e-10 Response = 7.4699411e-10 Projector = 7.4700885e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.34 sec, wall time      0.09 sec
shape (1469, 3744)
1st memory: 605.1 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 467.1 MiB

========================
iter = 2  energy = -3132.577672 energy diff = 0.007038
multiplicity <S^2> : Reference = 5.7627858e-10 Response = 5.7656641e-10 Projector = 5.7685424e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.31 sec, wall time      0.09 sec
shape (1469, 3744)
1st memory: 637.7 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 484.8 MiB

========================
iter = 3  energy = -3132.578894 energy diff = 0.001222
multiplicity <S^2> : Reference = 4.4363446e-10 Response = 4.4364311e-10 Projector = 4.4365176e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.27 sec, wall time      0.09 sec
shape (1469, 3744)
1st memory: 692.9 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 485.6 MiB

========================
iter = 4  energy = -3132.579054 energy diff = 0.000160
multiplicity <S^2> : Reference = 2.7061731e-10 Response = 2.7058204e-10 Projector = 2.7054678e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.41 sec, wall time      0.10 sec
shape (1469, 3744)
1st memory: 636.6 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 485.0 MiB

========================
iter = 5  energy = -3132.579205 energy diff = 0.000151
multiplicity <S^2> : Reference = 2.0726532e-10 Response = 2.0740441e-10 Projector = 2.0754351e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.15 sec, wall time      0.08 sec
shape (1469, 3744)
1st memory: 680.8 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 484.8 MiB

========================
iter = 6  energy = -3132.579194 energy diff = 0.000011
multiplicity <S^2> : Reference = 1.5126034e-10 Response = 1.5136518e-10 Projector = 1.5147002e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.36 sec, wall time      0.10 sec
shape (1469, 3744)
1st memory: 637.0 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 485.3 MiB

========================
iter = 7  energy = -3132.579195 energy diff = 0.000001
multiplicity <S^2> : Reference = 1.0965095e-10 Response = 1.0969232e-10 Projector = 1.0973369e-10

UOB-MP2 has converged
UOB-MP2 energy =  -3132.579195358332
shift = 0
thresh = 1e-05 
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.33 sec, wall time      0.09 sec
shape (1469, 3744)
1st memory: 617.5 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 481.2 MiB

========================
iter = 0  energy = -3132.253724 energy diff = 3132.253724
multiplicity <S^2> : Reference = 1.3239685e-09 Response = 1.322025e-09 Projector = 1.3200815e-09
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.39 sec, wall time      0.10 sec
shape (1469, 3744)
1st memory: 680.5 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 481.1 MiB

========================
iter = 1  energy = -3132.281721 energy diff = 0.027998
multiplicity <S^2> : Reference = 9.1479535e-10 Response = 9.145801e-10 Projector = 9.1436484e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.28 sec, wall time      0.09 sec
shape (1469, 3744)
1st memory: 617.7 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 484.2 MiB

========================
iter = 2  energy = -3132.283624 energy diff = 0.001903
multiplicity <S^2> : Reference = 7.5733908e-10 Response = 7.5794521e-10 Projector = 7.5855133e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.39 sec, wall time      0.10 sec
shape (1469, 3744)
1st memory: 680.6 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 485.5 MiB

========================
iter = 3  energy = -3132.284147 energy diff = 0.000523
multiplicity <S^2> : Reference = 6.3684524e-10 Response = 6.3681921e-10 Projector = 6.3679317e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.23 sec, wall time      0.08 sec
shape (1469, 3744)
1st memory: 617.6 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 485.6 MiB

========================
iter = 4  energy = -3132.284450 energy diff = 0.000303
multiplicity <S^2> : Reference = 4.5609738e-10 Response = 4.5641191e-10 Projector = 4.5672645e-10
eri1 (1469, 6903)
eri1 (1469, 6903)
    CPU time for making amplitude: integral transform      1.44 sec, wall time      0.10 sec
shape (1469, 3744)
1st memory: 681.4 MiB
eri1 (1469, 6903)
eri1 (1469, 6903)
2nd memory: 485.6 MiB

========================
iter = 5  energy = -3132.284458 energy diff = 0.000009
multiplicity <S^2> : Reference = 3.7238124e-10 Response = 3.726231e-10 Projector = 3.7286495e-10

UOB-MP2 has converged
UOB-MP2 energy =  -3132.2844581541594


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/ltkoanh/Al_B2LYP_6311_Gd_Cluster/Cluster/Al13-anion-singlet/tmp7wyc4gy0
max_memory 4000 MB (current use 263 MB)
number electrons alpha = 85  beta = 85
Set gradient conv threshold to 3.16228e-05
init E= -3129.93029167688
  alpha nocc = 85  HOMO = -0.793717701587353  LUMO = -0.649027971747991
  beta  nocc = 85  HOMO = -0.736663307953404  LUMO = -0.637788370443765
cycle= 1 E= -3130.31305940389  delta_E= -0.383  |g|= 1.26  |ddm|= 4.48
  alpha nocc = 85  HOMO = 0.442154307492311  LUMO = 0.508612275112146
  beta  nocc = 85  HOMO = 0.439450770959923  LUMO = 0.510129933200395
cycle= 2 E= -3131.03173200134  delta_E= -0.719  |g|= 0.839  |ddm|= 3.51
  alpha nocc = 85  HOMO = 0.18589463885264  LUMO = 0.393162238573302
  beta  nocc = 85  HOMO = 0.191306835503799  LUMO = 0.39112794016308
cycle= 3 E= -3131.61637945757  delta_E= -0.585  |g|= 0.0533  |ddm|= 1.33
  alpha nocc = 85  HOMO = 0.170670815644632  LUMO = 0.381020102605879
  beta  nocc = 85  HOMO = 0.173215907386822  LUMO = 0.379286094893348
cycle= 4 E= -3131.61986718633  delta_E= -0.00349  |g|= 0.0103  |ddm|= 0.11
  alpha nocc = 85  HOMO = 0.168525428961198  LUMO = 0.378759378141055
  beta  nocc = 85  HOMO = 0.169531826649056  LUMO = 0.377670502026629
cycle= 5 E= -3131.62013025884  delta_E= -0.000263  |g|= 0.00338  |ddm|= 0.0393
  alpha nocc = 85  HOMO = 0.168951996680155  LUMO = 0.378680492562175
  beta  nocc = 85  HOMO = 0.169145208947416  LUMO = 0.378220668027016
cycle= 6 E= -3131.62017161129  delta_E= -4.14e-05  |g|= 0.00129  |ddm|= 0.0197
  alpha nocc = 85  HOMO = 0.169017192931319  LUMO = 0.378585984530686
  beta  nocc = 85  HOMO = 0.16911402746783  LUMO = 0.378317427014888
cycle= 7 E= -3131.62017350363  delta_E= -1.89e-06  |g|= 0.00163  |ddm|= 0.00545
  alpha nocc = 85  HOMO = 0.169066506072371  LUMO = 0.378498342959114
  beta  nocc = 85  HOMO = 0.169090687245499  LUMO = 0.37839593043429
cycle= 8 E= -3131.62017691427  delta_E= -3.41e-06  |g|= 0.000262  |ddm|= 0.00443
  alpha nocc = 85  HOMO = 0.169078926320286  LUMO = 0.378450402823961
  beta  nocc = 85  HOMO = 0.169078671749908  LUMO = 0.378429762232558
cycle= 9 E= -3131.62017714726  delta_E= -2.33e-07  |g|= 7.34e-05  |ddm|= 0.00173
  alpha nocc = 85  HOMO = 0.16907715063509  LUMO = 0.378440790826617
  beta  nocc = 85  HOMO = 0.169077251745446  LUMO = 0.378438228824153
cycle= 10 E= -3131.6201771663  delta_E= -1.9e-08  |g|= 1.44e-05  |ddm|= 0.000483
  alpha nocc = 85  HOMO = 0.169077474259112  LUMO = 0.378439969386149
  beta  nocc = 85  HOMO = 0.169077530637976  LUMO = 0.378439907196675
cycle= 11 E= -3131.62017716694  delta_E= -6.43e-10  |g|= 2.32e-06  |ddm|= 9.06e-05
  alpha nocc = 85  HOMO = 0.169077508771524  LUMO = 0.378439988741717
  beta  nocc = 85  HOMO = 0.169077523091955  LUMO = 0.37843992482524
Extra cycle  E= -3131.62017716696  delta_E= -2.09e-11  |g|= 1.76e-06  |ddm|= 9.9e-06
converged SCF energy = -3131.62017716696  <S^2> = 1.3213253e-09  2S+1 = 1
